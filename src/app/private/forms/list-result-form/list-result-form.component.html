<div class="page-header animate__animated animate__fadeIn">
    <div class="page-block">
        <div class="row align-items-center">
            <div class="col-md-12">
                <div class="page-header-title">
                    <h2 class="m-b-10" [innerHtml]="'forms' | translate | changeTitle"></h2>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="row pt-4 animate__animated animate__fadeIn">
    <div class="col-sm-12">
        <!-- <div class="card">
            <div class="card-body border-bottom-0">
                <div class="row">
                    <div class="col-12">
                        <h3 class="border-title">
                            {{'list_forms' | translate}}
                        </h3>
                    </div> -->
        <div class="row pt-2 animate__animated animate__fadeIn">
            <div class="col-lg-2 col-md-2 col-sm-2 col-xs-12">
                <div class="row">
                    <div class="col-12 font-24">
                        <img src="assets/images/filter.png" class="me-4" style="vertical-align: initial;" alt=""> {{'filter' | translate}}
                    </div>
                    <div class="col-12">
                        <p-accordion [multiple]="true" styleClass="filter-business" expandIcon="pi pi-plus-circle" collapseIcon="pi pi-minus-circle">
                            <p-accordionTab [header]="'period'| translate">
                                <ul class="filter-list mb-0">
                                    <ng-container *ngIf="listPeriod.length==0; else nolistPeriod">
                                        <li>{{'no_records' | translate}}</li>
                                    </ng-container>
                                    <ng-template #nolistPeriod>
                                        <li *ngFor="let period of listPeriod" class="cursor-pointer" [ngClass]="{'text-pf-primary': periodo&&periodo.id==period.id}" (click)="applyFilterPeriod(period)">{{period.name | translate}}</li>
                                    </ng-template>
                                </ul>
                            </p-accordionTab>
                        </p-accordion>
                        <p-accordion [multiple]="true" styleClass="filter-business" expandIcon="pi pi-plus-circle" collapseIcon="pi pi-minus-circle">
                            <p-accordionTab [header]="'state'| translate">
                                <ul class="filter-list mb-0">
                                    <ng-container *ngIf="listState.length==0; else nolistState">
                                        <li>{{'no_records' | translate}}</li>
                                    </ng-container>
                                    <ng-template #nolistState>
                                        <li *ngFor="let state of listState" class="cursor-pointer" [ngClass]="{'text-pf-primary': status&&status.id==state.id}" (click)="applyFilterState(state)">{{state.name | translate}}</li>
                                    </ng-template>
                                </ul>
                            </p-accordionTab>
                        </p-accordion>
                        <p-accordion [multiple]="true" styleClass="filter-business" expandIcon="pi pi-plus-circle" collapseIcon="pi pi-minus-circle">
                            <p-accordionTab [header]="'code_form'| translate">
                                <ul class="filter-list mb-0">
                                    <ng-container *ngIf="listCode.length==0; else nolistCode">
                                        <li>{{'no_records' | translate}}</li>
                                    </ng-container>
                                    <ng-template #nolistCode>
                                        <li *ngFor="let code of listCode" class="cursor-pointer" [ngClass]="{'text-pf-primary': code_form&&code_form.code==code.code}" (click)="applyFilterCode(code)">{{code.code | translate}}</li>
                                    </ng-template>
                                </ul>
                            </p-accordionTab>
                        </p-accordion>
                    </div>
                </div>
            </div>
            <div class="col-lg-10 col-md-10 col-sm-10 col-xs-12">
                <div class="card">
                    <div class="card-body">

                        <div class="row">
                            <div class="col-lg-11 col-md-11 col-sm-11 col-xs-12">

                                <div class="row">
                                    <div class="col-lg-4 col-md-4 col-sm-4 col-xs-12 mb-2">
                                        <span class="p-input-icon-left w-100 w-search-list">
                                                                                <i class="pi pi-search" style="color: var(--pf-blue);"></i>
                                                                                <input type="text" [(ngModel)]="textSearch" (keyup)="applyFilter($event)" class="w-100" style="padding-left: 2.5rem !important; border-radius: 26px !important;" pInputText [placeholder]="'search_nom_form'  | translate" />
                                                                            </span>
                                    </div>
                                    <div class="col-lg-4 col-md-4 col-sm-4 col-xs-12 mb-2">
                                        <span class="p-input-icon-left w-100 w-search-list">
                                                                                <i class="pi pi-search" style="color: var(--pf-blue);"></i>
                                                                                <input type="text" [(ngModel)]="textSearchAssigned" (keyup)="applyFilterAssingned($event)" class="w-100" style="padding-left: 2.5rem !important; border-radius: 26px !important;" pInputText [placeholder]="'search_company_assigned' | translate" />
                                                                            </span>
                                    </div>
                                    <div class="col-lg-4 col-md-4 col-sm-4 col-xs-12 mb-2" *ngIf="role&&role.name=='COLABORADOR'">
                                        <span class="p-input-icon-left w-100 w-search-list">
                                                                                <i class="pi pi-search" style="color: var(--pf-blue);"></i>
                                                                                <input type="text" [(ngModel)]="textSearchAssing" (keyup)="applyFilterAssing($event)" class="w-100" style="padding-left: 2.5rem !important; border-radius: 26px !important;" pInputText [placeholder]="'search_company_assing' | translate" />
                                                                            </span>
                                    </div>
                                    <div class="col-lg-4 col-md-4 col-sm-4 col-xs-12 mb-2">
                                        <span class="p-input-icon-left w-100 w-search-list">
                                                                          <div class="search-calendar">
                                                                            <p-calendar
                                                                                  id="year"
                                                                                  [(ngModel)]="year"
                                                                                  (ngModelChange)="applyFilterYear()"
                                                                                  view="year"
                                                                                  dateFormat="yy"
                                                                                  inputId="yearpicker"
                                                                                  [placeholder]="'year' | translate"
                                                                                  [showClear]="true"
                                                                                  (onClear)="clearYear()"
                                                                                ></p-calendar>
                                                                          </div>
                                                                        </span>
                                    </div>
                                    <div class="col-lg-4 col-md-4 col-sm-4 col-xs-12 mb-2">
                                        <span class="p-input-icon-left w-100 w-search-list">
                                            <div class="search-calendar">
                                                <p-calendar
                                                    id="date_assing"
                                                    [(ngModel)]="date_assing"
                                                    (ngModelChange)="applyFilterYearAssing()"
                                                    [placeholder]="'date_assing' | translate"
                                                    dateFormat="dd/mm/yy"
                                                    [showClear]="true"
                                                ></p-calendar>
                                            </div>
                                        </span>
                                    </div>
                                    <div class="col-lg-4 col-md-4 col-sm-4 col-xs-12 mb-2">
                                        <span class="p-input-icon-left w-100 w-search-list">
                                            <div class="search-calendar">
                                                <p-calendar
                                                    id="date_close"
                                                    [(ngModel)]="date_close"
                                                    (ngModelChange)="applyFilterYearClose()"
                                                    [placeholder]="'date_close' | translate"
                                                    dateFormat="dd/mm/yy"
                                                    [showClear]="true"
                                                ></p-calendar>
                                            </div>
                                        </span>
                                    </div>
                                    <!-- <div class="col-lg-1 col-md-1 col-sm-1 col-xs-12 mb-2"> -->
                                    <!-- <button class="btn btn-pf-primary w-100  chang-clear" (click)="clear()" type="button">
                                                                            <img width="15px" class="btn-img  chang-clear" src="assets/images/times.png" alt=""/>
                                                                        </button>
                                    </div> -->
                                </div>
                            </div>
                            <div class="col-lg-1 col-md-1 col-sm-1 col-xs-12 d-flex align-items-center  mt-2">
                                <button class="btn btn-pf-primary w-100  chang-clear" (click)="clear()" type="button">
                                <img width="15px" class="btn-img  chang-clear" src="assets/images/times.png" alt=""/>
                            </button>
                            </div>
                        </div>

                    </div>
                    <div class="example-container">
                        <app-load-table></app-load-table>
                        <table mat-table [dataSource]="dataSource" matSort multiTemplateDataRows class="table-list-business">
                            <ng-container matColumnDef="completed">
                                <th mat-header-cell *matHeaderCellDef class="text-center" width="15%"> {{'completed' | translate}} </th>
                                <td mat-cell *matCellDef="let element">
                                    <div class="porcent-form py-1 me-2">
                                        <div id="middle-circle">
                                            {{element.percentage_of_completion}}%
                                        </div>
                                        <div id="progress-spinner" [ngStyle]="{'background':'conic-gradient(var(--pf-blue)'+element.percentage_of_completion+'%,rgb(242, 242, 242) '+element.percentage_of_completion+'%)'}"></div>
                                    </div>

                                </td>
                            </ng-container>
                            <!-- 
                            <ng-container matColumnDef="select">
                                <th mat-header-cell *matHeaderCellDef width="10%" class="text-center">
                                </th>
                                <td mat-cell *matCellDef="let row" class="text-center">
                                    <mat-checkbox (click)="$event.stopPropagation()" (change)="$event ? selection.toggle(row) : null" [checked]="selection.isSelected(row)" [aria-label]="checkboxLabel(row)">
                                    </mat-checkbox>
                                </td>
                            </ng-container> -->

                            <ng-container matColumnDef="code_form">
                                <th mat-header-cell *matHeaderCellDef width="30%"> {{'name_form' | translate}} </th>
                                <td mat-cell *matCellDef="let element" (click)="checked(element)">
                                    <span class="d-block">
                                                    {{element.name}} 
                                                </span>
                                    <span class="d-block font-12 text-pf-secondary">
                                                    {{'code' | translate}}: {{element.code_form}}
                                                </span>
                                </td>
                            </ng-container>
                            <ng-container matColumnDef="date">
                                <th mat-header-cell *matHeaderCellDef width="10%"> {{'period' | translate}} </th>
                                <td mat-cell *matCellDef="let element" (click)="checked(element)"> {{element.period.name | translate}} </td>
                            </ng-container>
                            <ng-container matColumnDef="assigned_company">
                                <th mat-header-cell *matHeaderCellDef width="20%"> {{'assigned_company' | translate}} </th>
                                <td mat-cell *matCellDef="let element" (click)="checked(element)"> {{element.assigned_company?element.assigned_company.name:('no_description' | translate)}} </td>
                            </ng-container>
                            <ng-container matColumnDef="allocating_company" *ngIf="role&&role.name=='COLABORADOR'">
                                <th mat-header-cell *matHeaderCellDef width="20%"> {{'allocating_company' | translate}} </th>
                                <td mat-cell *matCellDef="let element" (click)="checked(element)"> {{element.allocating_company?element.allocating_company.name:('no_description' | translate)}} </td>
                            </ng-container>

                            <ng-container matColumnDef="actions" *ngIf="!assingDataRoute">
                                <th mat-header-cell *matHeaderCellDef width="10%" class="text-center"> {{'action' | translate}} </th>
                                <td mat-cell *matCellDef="let element" routerLink="/forms/view-forms/view-form" [queryParams]="{idForm: element.id}" class="text-center">
                                    <button class="btn btn-pf-primary export-btn"> {{'view' | translate}}</button>
                                </td>
                            </ng-container>
                            <ng-container matColumnDef="more">
                                <th mat-header-cell *matHeaderCellDef width="1%" class="text-center"> {{'more' | translate}} </th>
                                <td mat-cell *matCellDef="let element" class="text-center">
                                    <button class="btn border-none" style="margin-top: 5px;" (click)="expand(element)">
                                        <i class="pi pi-chevron-down"></i>
                                    </button>
                                </td>
                            </ng-container>

                            <ng-container matColumnDef="expandedDetail">
                                <td mat-cell *matCellDef="let element" [attr.colspan]="columnsToDisplay.length">
                                    <div class="example-element-detail" [@detailExpand]="element == expandedElement ? 'expanded' : 'collapsed'">
                                        <div class="py-3 w-75 d-block mx-auto more-business">
                                            <div class="row">
                                                <div class="col-lg-4 col-md-4 col-sm-4 col-xs-12">
                                                    <div class="field">
                                                        <label class="d-block">{{ "assigned_company" | translate }}</label>
                                                        <input type="text" class="w-100" pInputText readonly value="{{element.assigned_company?element.assigned_company.name:('no_description' | translate) }}" />
                                                    </div>
                                                </div>
                                                <div class="col-lg-4 col-md-4 col-sm-4 col-xs-12" *ngIf="role&&role.name=='COLABORADOR'">
                                                    <div class="field">
                                                        <label class="d-block">{{ "allocating_company" | translate }}</label>
                                                        <input type="text" class="w-100" pInputText readonly value="{{ element.allocating_company?element.allocating_company.name:('no_description' | translate) }}" />
                                                    </div>
                                                </div>
                                                <div class="col-lg-4 col-md-4 col-sm-4 col-xs-12">
                                                    <div class="field">
                                                        <label class="d-block">{{ "period" | translate }}</label>
                                                        <input type="text" class="w-100" pInputText readonly value="{{element.period.name | translate }}" />
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- <ul class="filter-list">
                                                <li>
                                                    <span class="mb-0 fw-bold">{{'code' | translate}}</span>:
                                                    <p class="mb-0" style="color: rgb(135 135 135);">{{element.code}}</p>
                                                </li>
                                            </ul> -->
                                        </div>
                                    </div>
                                </td>
                            </ng-container>

                            <tr mat-header-row *matHeaderRowDef="columnsToDisplay; sticky: true"></tr>
                            <tr mat-row *matRowDef="let row; columns: columnsToDisplay;" class="example-element-row" [class.example-expanded-row]="expandedElement === row" [ngClass]="{'highlight': selectedRowIndex ==row.id}"></tr>
                            <tr mat-row *matRowDef="let element; columns: ['expandedDetail']" class="example-detail-row"></tr>
                            <tr class="mat-row" *matNoDataRow>
                                <td class="mat-cell" *ngIf="filterValue!=''; else noData" colspan="4">{{'no_found' | translate}} "{{filterValue}}"</td>
                                <ng-template #noData>
                                    <td class="mat-cell" colspan="4">{{'no_records' | translate}}</td>
                                </ng-template>

                            </tr>
                        </table>
                    </div>

                    <mat-paginator (page)="paginationChangeSize($event)" [length]="listSize" [pageSizeOptions]="[10, 25, 50, 100]"></mat-paginator>

                </div>
            </div>
        </div>
    </div>
</div>
<!-- </div>
    </div>
</div> -->