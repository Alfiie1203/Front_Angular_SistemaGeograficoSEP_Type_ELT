<div class="page-header animate__animated animate__fadeIn">
    <div class="page-block">
        <div class="row align-items-center">
            <div class="col-md-12">
                <div class="page-header-title">

                    <h2 class="m-b-10" [innerHtml]="'my_tracebility' | translate | changeTitle"></h2>
                    <button *ngIf="permissionAdd" class="btn btn-pf-primary more-btn ml-auto" [routerLink]="linkByRole()">
            <img src="assets/images/more.png" width="20px" class="btn-img cursor-pointer" alt="" />
          </button>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="row pt-4 animate__animated animate__fadeIn">
    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 ">
        <div class="col-md-12">
            <div class="card">
                <div class="card-body">
                    <div class="row">
                        <div class="col-12">
                            <button *ngIf="permissionView" (click)="displayFilter=true" class="btn btn-pf-primary export-btn ms-auto d-block">
                {{ "filter" | translate }}
              </button>
                        </div>
                    </div>
                    <!-- <form autocomplete="off" [formGroup]="map_form" id="map">
                        <div class="row">
                            <div *ngIf="role == 'COLABORADOR'" class="col-lg-12 col-md-4 col-sm-12 col-xs-12">
                                <div class="field">
                                    <label class="text-search">{{
                    "companies" | translate
                  }}</label>
                                    <p-dropdown id="map_listPeriod" [options]="companyList" optionLabel="name_company" [filter]="true" filterBy="name_company" [placeholder]="'company' | translate" [autoDisplayFirst]="false" formControlName="map_company_list">
                                        <ng-template pTemplate="selectedItem">
                                            <div class="country-item country-item-value" *ngIf="map_form.get('map_company_list')?.value['name_company']">
                                                <div>
                                                    {{ map_form.get('map_company_list')?.value['name_company'] | translate }}
                                                </div>
                                            </div>
                                        </ng-template>
                                        <ng-template let-item pTemplate="item">
                                            <div class="country-item">
                                                <div>{{ item.name_company | translate }}</div>
                                            </div>
                                        </ng-template>
                                    </p-dropdown>
                                    <div *ngIf="
                      fmap['map_company_list'].invalid &&
                      fmap['map_company_list'].touched &&
                      fmap['map_company_list'].errors != null
                    " class="text-danger ps-2 pt-1 font-12">
                                        <small id="password-help" *ngIf="fmap['map_company_list'].errors['required']" class="block">{{ "required_field" | translate }}</small
                    >
                  </div>
                </div>

                
              </div>



              <div class="col-lg-4 col-md-4 col-sm-4 col-xs-12">
                <div class="field">
                  <label class="text-search"
                    >{{ "supplier_company" | translate }}
                    </label
                  >
                  <input
                    id="map_search"
                    formControlName="map_search"
                    class="w-100"
                    type="text"
                    [placeholder]="'search' | translate"
                    pInputText
                  />
                </div>
              </div>
              <div class="col-lg-4 col-md-4 col-sm-4 col-xs-12">
                <div class="field">
                    <label class="text-search">{{
                      "year" | translate
                    }}</label>
                    <span class="p-input-icon-left w-100 w-search-list">
                      <i class="pi pi-calendar" style="color: var(--pf-blue)"></i>
                      <p-calendar
                            id="map_year"
                            formControlName="map_year"
                            view="year"
                            dateFormat="yy"
                            inputId="yearpicker"
                            [placeholder]="'year' | translate"
                            [showClear]="true"
                            
                          ></p-calendar>
                    </span>
                </div>
                
              </div>
              <div class="col-lg-4 col-md-4 col-sm-4 col-xs-12">
                <div class="field">
                  <label class="text-search">{{
                    "period" | translate
                  }}</label>
                  <p-dropdown
                  id="map_listPeriod"
                  [options]="listPeriod"
                  optionLabel="name"
                  [filter]="true"
                  filterBy="name"
                  [placeholder]="'period' | translate"
                  [autoDisplayFirst]="false"
                  formControlName="map_period"
                  [showClear]="true"
                  
                >
                  <ng-template pTemplate="selectedItem">
                    <div
                      class="country-item country-item-value"
                      *ngIf="map_form.get('map_period')?.value['name']"
                    >
                      <div>
                        {{ map_form.get('map_period')?.value['name'] | translate }}
                      </div>
                    </div>
                  </ng-template>
                  <ng-template let-period pTemplate="item">
                    <div class="country-item">
                      <div>{{ period.name | translate }}</div>
                    </div>
                  </ng-template>
                </p-dropdown>
                </div>

                
              </div>
              


              <div class="col-lg-4 col-md-4 col-sm-4 col-xs-12">
                <div class="field">
                  <label class="text-search"
                    >{{ "country" | translate }}
                    </label
                  >
                  <p-dropdown *ngIf="listCountry"
                    id="map_country"
                    formControlName="map_country"
                    [options]="listCountry"
                    optionLabel="name"
                    [filter]="true"
                    filterBy="name"
                    [showClear]="true"
                    (onClear)="clearCountrySearchMap()"
                    [placeholder]="'selected_country' | translate"
                    [autoDisplayFirst]="false"
                    (onChange)="getListRegions( (map_form.value?.map_country?map_form.value?.map_country.id:0) )"
                  >
                    <ng-template pTemplate="selectedItem">
                      <div
                        class="country-item country-item-value"
                        *ngIf="map_form.get('map_country')"
                      >
                        <div>{{ map_form.get("map_country")?.value.name }}</div>
                      </div>
                    </ng-template>
                    <ng-template let-country pTemplate="item">
                      <div class="country-item">
                        <div>{{ country.name }}</div>
                      </div>
                    </ng-template>
                  </p-dropdown>
                  
                </div>
              </div>

              <div class="col-lg-4 col-md-4 col-sm-4 col-xs-12">
                <div class="field">
                  <label class="text-search"
                    >{{ "state" | translate }}
                    </label
                  >
                  <p-dropdown
                    id="state"
                    formControlName="map_region"
                    [options]="listRegions"
                    optionLabel="name"
                    [filter]="true"
                    filterBy="name"
                    [showClear]="true"
                    (onClear)="clearRegionSearchMap()"
                    [placeholder]="'selected_state' | translate"
                    [autoDisplayFirst]="false"
                    (onChange)="
                      getListCities(
                        (map_form.value?.map_country?map_form.value?.map_country.id:0),
                        (map_form.value?.map_region?map_form.value.map_region.id:0)
                      )
                    "
                  >
                    <ng-template pTemplate="selectedItem">
                      <div
                        class="country-item country-item-value"
                        *ngIf="map_form.get('map_region')"
                      >
                        <div>{{ map_form.get("map_region")?.value.name }}</div>
                      </div>
                    </ng-template>
                    <ng-template let-region pTemplate="item">
                      <div class="country-item">
                        <div>{{ region.name }}</div>
                      </div>
                    </ng-template>
                  </p-dropdown>
                  
                </div>
              </div>

              <div class="col-lg-4 col-md-4 col-sm-4 col-xs-12">
                <div class="field">
                  <label class="text-search"
                    >{{ "municipality" | translate }}
                    </label
                  >
                  <p-dropdown
                    id="map_ciudad"
                    formControlName="map_ciudad"
                    [options]="listCities"
                    optionLabel="name"
                    [filter]="true"
                    filterBy="name"
                    [showClear]="true"
                    (onClear)="clearCitySearchMap()"
                    [placeholder]="'selected_municipality' | translate"
                    [autoDisplayFirst]="false"
                  >
                    <ng-template pTemplate="selectedItem">
                      <div
                        class="country-item country-item-value"
                        *ngIf="map_form.get('map_ciudad')"
                      >
                        <div>{{ map_form.get("map_ciudad")?.value.name }}</div>
                      </div>
                    </ng-template>
                    <ng-template let-city pTemplate="item">
                      <div class="country-item">
                        <div>{{ city.name }}</div>
                      </div>
                    </ng-template>
                  </p-dropdown>
                  
                </div>
              </div>

              <div class="col-lg-6 col-md-6 col-sm-6 col-xs-12">
                <div class="field">
                  <label class="text-search"
                    >{{ "commodity" | translate }}
                    </label
                  >
                  <p-dropdown
                    id="map_commodity"
                    formControlName="map_commodity"
                    [options]="listCommodity"
                    optionLabel="name"
                    [filter]="true"
                    filterBy="name"
                    [placeholder]="'selected_commodity' | translate"
                    [showClear]="true"
                    (onClear)="clearCommoditySearchMap()"
                    [autoDisplayFirst]="false"
                    (onChange)="getListActorType(map_form.value.map_commodity.id)"
                  >
                    <ng-template pTemplate="selectedItem">
                      <div
                        class="country-item country-item-value"
                        *ngIf="map_form.get('map_commodity')"
                      >
                        <div>
                          {{ map_form.get("map_commodity")?.value.name[lang.code] }}
                        </div>
                      </div>
                    </ng-template>
                    <ng-template let-country pTemplate="item">
                      <div class="country-item">
                        <div>{{ country.name[lang.code] }}</div>
                      </div>
                    </ng-template>
                  </p-dropdown>
                  
                </div>
              </div>

              <div class="col-lg-6 col-md-6 col-sm-6 col-xs-12">
                <div class="field">
                  <label class="text-search"
                    >{{ "type_actor" | translate }}
                    </label
                  >
                  <p-dropdown
                    id="map_tipo_actor"
                    formControlName="map_tipo_actor"
                    [options]="listActorType"
                    optionLabel="name"
                    [filter]="true"
                    filterBy="name"
                    [placeholder]="'selected_type_actor' | translate"
                    [showClear]="true"
                    (onClear)="clearTipoActorSearchMap()"
                    [autoDisplayFirst]="false"
                    (onChange)="getTemCode()"
                  >
                    <ng-template pTemplate="selectedItem">
                      <div
                        class="country-item country-item-value"
                        *ngIf="map_form.get('map_tipo_actor')"
                      >
                        <div>
                          {{ map_form.get("map_tipo_actor")?.value.name[lang.code] }}
                        </div>
                      </div>
                    </ng-template>
                    <ng-template let-country pTemplate="item">
                      <div class="country-item">
                        <div>{{ country.name[lang.code] }}</div>
                      </div>
                    </ng-template>
                  </p-dropdown>
                  
                </div>
              </div>
              <div class="col-lg-6 col-md-6 col-sm-6 col-xs-12">
                <button
                *ngIf="permissionView"
                (click)="resetAllSearcMap()"
                class="btn btn-pf-primary export-btn"
              >
                {{ "search_all" | translate }}
              </button>
              </div>
              
            </div>
          </form> -->
                </div>
                <div class="map-container">
                    <google-map id="map" [options]="options" width="100%" style="border-radius: 27px !important">
                        <map-marker id="map-marker" *ngFor="let item of positionList;let i = index" #markerElem="mapMarker" [options]="item.markerOptions" (mapClick)="markerDetail(markerElem, item)" [position]="item.position">
                            <map-info-window #info1>
                                <div class="map-info-window">
                                    <div class="map-info-title">
                                        <b>{{ markerDataInfo?markerDataInfo.marker_info:'' }}</b>
                                        <div class="info-window-extra">
                                            <hr>
                                            <div class="company-detail" *ngIf="markerDataInfo && markerDataInfo.marker_type != 'principal'">
                                                {{ 'company' | translate }}: {{ markerDataInfo.reported_company }}
                                            </div>

                                        </div>
                                        <!-- <div *ngIf="(data_pattern && markerDataInfo.marker_level == 2)">
                      <div>
                        {{ 'supplier_' | translate }}:
                      </div>
                      <div>
                        <b>{{ data_pattern.data.supplier_name }}</b>
                      </div>
                      
                    </div> -->
                                    </div>
                                    <div class="btn-expand" *ngIf="markerDataInfo &&
                    markerDataInfo.marker_type != 'principal' &&
                    markerDataInfo.marker_level == 1
                    ">
                                        <button (click)="viewMapDetail()" class="btn-level-2 btn btn-pf-primary export-btn">
                      {{ "view" | translate }}
                    </button>
                                    </div>
                                </div>
                            </map-info-window>


                        </map-marker>
                    </google-map>
                </div>
            </div>
        </div>
        <!-- <div class="col-md-3">
      <div class="card">
        <div class="card-body">
          <div class="data-leyenda">
            <div class="leyenda-info">
              <div class="point type-1">
                <div class="point-center"></div>
              </div>
              <div class="text">
                {{ 'company' | translate }}
              </div>
            </div>
            <div class="leyenda-info">
              <div class="point type-2">
                <div class="point-center"></div>
              </div>
              <div class="text cell" title="Leve 1">
                {{ 'supply_base' | translate }}
              </div>
            </div>
            <div class="leyenda-info">
              <div class="point type-3">
                <div class="point-center"></div>
              </div>
              <div class="text cell" title="Leve 2">
                {{ 'supply_base' | translate }} 2
              </div>
            </div>
            
          </div>
        </div>
      </div>
    </div> -->
    </div>
    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 mt-3">
        <div class="card">
            <div class="card-body">
                <form autocomplete="off" [formGroup]="form">
                    <div class="row">
                        <div class="col-md-4">
                            <label class="text-search">{{
                "year" | translate
                }}</label>
                            <span class="p-input-icon-left w-100 w-search-list">
                <i class="pi pi-calendar" style="color: var(--pf-blue)"></i>


                <p-calendar id="year" formControlName="year" view="year" dateFormat="yy" inputId="yearpicker"
                  [placeholder]="'year' | translate" [showClear]="true"></p-calendar>




              </span>
                        </div>
                        <div class="col-md-4">
                            <label class="text-search">{{ "period" | translate }}</label>
                            <span class="p-input-icon-left w-100 w-search-list">
                <i class="pi pi-calendar" style="color: var(--pf-blue)"></i>


                <p-dropdown id="listPeriod" [options]="listPeriod" optionLabel="name" [filter]="true" filterBy="name"
                  [placeholder]="'period' | translate" [autoDisplayFirst]="false" formControlName="period"
                  [showClear]="true">
                  <ng-template pTemplate="selectedItem">
                    <div class="country-item country-item-value" *ngIf="form.get('period')?.value['name']">
                      <div>
                        {{ form.get('period')?.value['name'] | translate }}
                      </div>
                    </div>
                  </ng-template>
                  <ng-template let-period pTemplate="item">
                    <div class="country-item">
                      <div>{{ period.name | translate }}</div>
                    </div>
                  </ng-template>
                </p-dropdown>

              </span>
                        </div>
                        <div class="col-md-4">
                            <label class="text-search">{{ "search" | translate }}</label>
                            <span class="p-input-icon-left w-100 w-search-list">
                <i class="pi pi-search" style="color: var(--pf-blue)"></i>
                <input type="text" formControlName="search" class="w-100" style="
                    padding-left: 2.5rem !important;
                    border-radius: 26px !important;
                  " pInputText [placeholder]="'name_nit_country' | translate" />
              </span>
                        </div>
                    </div>
                </form>
            </div>
            <div class="example-container position-relative">
                <app-load-table></app-load-table>
                <table mat-table [dataSource]="dataSource" matSort multiTemplateDataRows class="table-list-business">
                    <ng-container matColumnDef="name">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header width="30%">
                            {{ "reported_company" | translate }}
                        </th>
                        <td mat-cell *matCellDef="let element" (click)="checked(element)">
                            <span class="d-block">
                {{ element.reported_company }}
              </span>

                        </td>
                    </ng-container>
                    <ng-container matColumnDef="supplier_company">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header width="20%">
                            {{ "supplier_company" | translate }}
                        </th>
                        <td mat-cell *matCellDef="let element" (click)="checked(element)">
                            <span class="d-block">
                {{ element.supplier_company }}
              </span>
                            <span class="d-block font-12 text-pf-secondary">
                {{ element.supplier_tax_number }}
              </span>
                        </td>
                    </ng-container>
                    <ng-container matColumnDef="year">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header width="10%">
                            {{ "year" | translate }}
                        </th>
                        <td mat-cell *matCellDef="let element" (click)="checked(element)">
                            {{ element.year }}
                        </td>
                    </ng-container>
                    <ng-container matColumnDef="type_actor">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header width="10%">
                            {{ "period" | translate }}
                        </th>
                        <td mat-cell *matCellDef="let element" (click)="checked(element)">
                            {{ element.period | periodName | translate }}
                        </td>
                    </ng-container>

                    <!-- <ng-container matColumnDef="switch">
                        <th mat-header-cell *matHeaderCellDef width="10%"> </th>
                        <td mat-cell *matCellDef="let element"> 
                            <div class="form-check form-switch">
                                <input class="form-check-input" [(ngModel)]="element.status" onclick="return false" type="checkbox" role="switch" id="flexSwitchCheckDefault">
                            </div>
                        </td>
                    </ng-container> -->

                    <ng-container matColumnDef="actions">
                        <th mat-header-cell *matHeaderCellDef width="15%" class="text-center">
                            {{ "action" | translate }}
                        </th>
                        <td mat-cell *matCellDef="let element" class="text-center">
                            <button *ngIf="permissionView" (click)="viewTraceability(element.id)" class="btn btn-pf-primary export-btn">
                {{ "view" | translate }}
              </button>
                            <!-- <button class="btn border-none" style="margin-top: 5px;" [matMenuTriggerFor]="menu">
                                <i class="pi pi-ellipsis-v"></i>
                            </button> -->
                            <!-- <mat-menu #menu="matMenu">
                                <button (click)="expand(element)" class="view-more" mat-menu-item>
                                    <i class="icon-option pi pi-eye" style="vertical-align: middle;"></i>
                                    <span *ngIf="expandedElement==null">{{'view_more' | translate}}</span>
                                    <span *ngIf="expandedElement!=null && expandedElement.id==element.id" >{{'hide' | translate}}</span>
                                    <span *ngIf="expandedElement!=null && expandedElement.id!=element.id" >{{'view_more' | translate}}</span>
                                </button>
                                <button *ngIf="permissionChange" (click)="edit(element)" mat-menu-item>
                                    <img src="assets/images/edit.png" class="icon-option" alt="">
                                    <span>{{'edit' | translate}}</span>
                                </button>
                                <button *ngIf="permissionDelete" (click)="showDelete(element)" mat-menu-item class="text-danger">
                                    <img src="assets/images/delete.png" class="icon-option" alt="">
                                    <span>{{'delete' | translate}}</span>
                                </button>
                            </mat-menu> -->
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="more">
                        <th mat-header-cell *matHeaderCellDef width="1%" class="text-center">
                            {{ "more" | translate }}
                        </th>
                        <td mat-cell *matCellDef="let element" class="text-center">
                            <button class="btn border-none" style="margin-top: 5px" (click)="expand(element)">
                <i class="pi pi-chevron-down"></i>
              </button>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="expandedDetail">
                        <td mat-cell *matCellDef="let element" [attr.colspan]="columnsToDisplay.length">
                            <div class="example-element-detail" [@detailExpand]="
                  element == expandedElement ? 'expanded' : 'collapsed'
                ">
                                <div class="py-3 w-75 d-block mx-auto more-business">
                                    <div class="row">

                                        <div class="col-lg-4 col-md-4 col-sm-4 col-xs-12">
                                            <div class="field">
                                                <label class="d-block">{{ "supplier_company" | translate }}</label>
                                                <input type="text" class="w-100" pInputText readonly value="{{ element.supplier_company }}" />
                                            </div>
                                        </div>
                                        <div class="col-lg-4 col-md-4 col-sm-4 col-xs-12">
                                            <div class="field">
                                                <label class="d-block">{{ "year" | translate }}</label>
                                                <input type="text" class="w-100" pInputText readonly value="{{ element.year }}" />
                                            </div>
                                        </div>
                                        <div class="col-lg-4 col-md-4 col-sm-4 col-xs-12">
                                            <div class="field">
                                                <label class="d-block">{{ "period" | translate }}</label>
                                                <input type="text" class="w-100" pInputText readonly value="{{  element.period | periodName | translate }}" />
                                            </div>
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </td>
                    </ng-container>

                    <tr mat-header-row *matHeaderRowDef="columnsToDisplay; sticky: true"></tr>
                    <tr mat-row *matRowDef="let row; columns: columnsToDisplay" class="example-element-row" [class.example-expanded-row]="expandedElement === row" [ngClass]="{ highlight: selectedRowIndex == row.id }"></tr>
                    <tr mat-row *matRowDef="let element; columns: ['expandedDetail']" class="example-detail-row"></tr>
                    <tr class="mat-row" *matNoDataRow>
                        <td class="mat-cell" *ngIf="filterValue != ''; else noData" colspan="4">
                            {{ "no_found" | translate }} "{{ filterValue }}"
                        </td>
                        <ng-template #noData>
                            <td class="mat-cell" colspan="4">
                                {{ "no_records" | translate }}
                            </td>
                        </ng-template>
                    </tr>
                </table>
            </div>
            <div class="row">
                <p-overlayPanel #op_en [dismissable]="true" [showCloseIcon]="false">
                    <ng-template pTemplate>
                        <ul *ngIf="!formato" class="pl-2 ml-2 mt-0 mb-0 font-13" style="line-height: 1.5">
                            <ng-container>
                                <li>{{ "debe_seleccionar_un_formato" | translate }}</li>
                            </ng-container>
                        </ul>
                    </ng-template>
                </p-overlayPanel>
                <div class="col-md-6 col-sm-12 col-xs-12 col-lg-6">
                    <ng-container *ngIf="permissionExport">
                        <div *ngIf="listSize" class="row" style="height: 100%; width: 100%;">
                            <div class="btn-container">
                                <button (click)="exportar($event, op_en)" class="btn btn-pf-primary export-btn">
                              {{ "export" | translate }}
                            </button>
                                <p-dropdown class="drop-down-f" id="formato" [options]="formatos" [(ngModel)]="formato" optionLabel="name" [filter]="true" filterBy="name" [placeholder]="'formato' | translate" [autoDisplayFirst]="false">
                                    <ng-template pTemplate="selectedItem">
                                        <div class="f-item f-item-value">
                                            <div>{{ formato.name | translate }}</div>
                                        </div>
                                    </ng-template>
                                    <ng-template let-f pTemplate="item">
                                        <div class="f-item">
                                            <div>{{ f.name | translate }}</div>
                                        </div>
                                    </ng-template>
                                </p-dropdown>
                            </div>
                        </div>

                    </ng-container>
                </div>
                <div class="col-md-6 col-sm-12 col-lg-6  col-xs-12">
                    <mat-paginator (page)="paginationChangeSize($event)" [length]="listSize" [pageSizeOptions]="[10, 25, 50, 100]"></mat-paginator>
                </div>
            </div>
        </div>
    </div>

</div>

<p-dialog *ngIf="enterprise != undefined" [(visible)]="display" [modal]="true" [breakpoints]="{ '960px': '75vw' }" [style]="{ width: '40vw' }" [draggable]="false" [resizable]="false" styleClass="dialog-delete">
    <div class="row">
        <div class="col-12">
            <h5 class="text-center">
                <b> {{ "description_delete" | translate }} </b>
            </h5>
        </div>
        <div class="col-lg-6 col-md-6 col-sm-6 col-xs-12">
            <div class="field">
                <label for="email" class="d-block">{{
          "supplier_company" | translate
          }}</label>
                <input id="email" [(ngModel)]="enterprise.supplier_company" class="w-100" type="text" readonly pInputText />
            </div>
        </div>
        <div class="col-lg-6 col-md-6 col-sm-6 col-xs-12">
            <div class="field">
                <label for="email" class="d-block">{{ "period" | translate }}</label>
                <input id="email" [(ngModel)]="enterprise.period" class="w-100" type="text" readonly pInputText />
            </div>
        </div>
        <div class="col-6">
            <button class="btn btn-cancel w-100" (click)="display = false">
        {{ "cancel" | translate }}
      </button>
        </div>
        <div class="col-6">
            <ng-container *ngIf="!loading; else load">
                <button class="btn btn-outline-danger w-100" (click)="delete()">
          {{ "delete" | translate }}
        </button>
            </ng-container>
            <ng-template #load>
                <span class="spinner-grow text-pf-primary d-block mx-auto" tyle="width: 1.5rem; height: 1.5rem;"></span>
            </ng-template>
        </div>
    </div>
</p-dialog>

<p-dialog [(visible)]="displayConfirm" [modal]="true" [breakpoints]="{ '960px': '75vw' }" [style]="{ width: '35vw' }" [draggable]="false" [resizable]="false" styleClass="dialog-delete">
    <div class="row text-center">
        <div class="col-12">
            <h3 class="text-center">
                <b> {{ "delete_success" | translate }} </b>
            </h3>
            <p>{{ "description_delete_success" | translate }}</p>
        </div>
        <div class="col-12">
            <img src="assets/images/check.png" class="mx-auto d-block" alt="" />
        </div>
        <div class="col-12 pt-4">
            <button class="btn btn-pf-primary p-btn" (click)="displayConfirm = false">
        {{ "accept" | translate }}
      </button>
        </div>
    </div>
</p-dialog>





<p-dialog [(visible)]="displayFilter" [modal]="true" [breakpoints]="{'960px': '95vw'}" [style]="{width: '80vw'}" [draggable]="false" [resizable]="false" styleClass="dialog-delete dialog-question">
    <div class="p-dialog-header-icons close-icon">
        <button type="button" class="p-ripple p-element  p-dialog-header-icon p-dialog-header-close p-link" (click)="displayFilter=false"><span class="p-dialog-header-close-icon pi pi-times"></span></button>
    </div>
    <div class="container p-2" style="width: 90%;">
        <div class="row">
            <div class="col-12">
                <form autocomplete="off" [formGroup]="map_form" id="map">
                    <div class="row">
                        <div *ngIf="role == 'COLABORADOR'" class="col-lg-4 col-md-4 col-sm-4 col-xs-12">
                            <div class="field">
                                <label class="text-search">{{
                  "companies" | translate
                  }}</label>
                                <p-dropdown appendTo="body" id="map_listPeriod" [options]="companyList" optionLabel="name_company" [filter]="true" filterBy="name_company" [placeholder]="'company' | translate" [autoDisplayFirst]="false" formControlName="map_company_list">
                                    <ng-template pTemplate="selectedItem">
                                        <div class="country-item country-item-value" *ngIf="map_form.get('map_company_list')?.value['name_company']">
                                            <div>
                                                {{ map_form.get('map_company_list')?.value['name_company'] | translate }}
                                            </div>
                                        </div>
                                    </ng-template>
                                    <ng-template let-item pTemplate="item">
                                        <div class="country-item">
                                            <div>{{ item.name_company | translate }}</div>
                                        </div>
                                    </ng-template>
                                </p-dropdown>
                                <div *ngIf="
        fmap['map_company_list'].invalid &&
        fmap['map_company_list'].touched &&
        fmap['map_company_list'].errors != null
      " class="text-danger ps-2 pt-1 font-12">
                                    <small id="password-help" *ngIf="fmap['map_company_list'].errors['required']" class="block">{{
                    "required_field" | translate }}</small>
                                </div>
                            </div>


                        </div>

                        <div [ngClass]="role == 'COLABORADOR'?'col-lg-4 col-md-4 col-sm-4 col-xs-12':'col-lg-6 col-md-6 col-sm-6 col-xs-12'">
                            <div class="field">
                                <label class="text-search">{{ "commodity" | translate }}
              </label>
                                <p-dropdown appendTo="body" id="map_commodity" formControlName="map_commodity" [options]="listCommodity" optionLabel="name" [filter]="true" filterBy="name" [placeholder]="'selected_commodity' | translate" [showClear]="true" (onClear)="clearCommoditySearchMap()"
                                    [autoDisplayFirst]="false" (onChange)="getListActorType(map_form.value.map_commodity.id)">
                                    <ng-template pTemplate="selectedItem">
                                        <div class="country-item country-item-value" *ngIf="map_form.get('map_commodity')">
                                            <div>
                                                {{ map_form.get("map_commodity")?.value.name[lang.code] }}
                                            </div>
                                        </div>
                                    </ng-template>
                                    <ng-template let-country pTemplate="item">
                                        <div class="country-item">
                                            <div>{{ country.name[lang.code] }}</div>
                                        </div>
                                    </ng-template>
                                </p-dropdown>

                            </div>
                        </div>

                        <div [ngClass]="role == 'COLABORADOR'?'col-lg-4 col-md-4 col-sm-4 col-xs-12':'col-lg-6 col-md-6 col-sm-6 col-xs-12'">
                            <div class="field">
                                <label class="text-search">{{ "type_actor" | translate }}
              </label>
                                <p-dropdown appendTo="body" id="map_tipo_actor" formControlName="map_tipo_actor" [options]="listActorType" optionLabel="name" [filter]="true" filterBy="name" [placeholder]="'selected_type_actor' | translate" [showClear]="true" (onClear)="clearTipoActorSearchMap()"
                                    [autoDisplayFirst]="false" (onChange)="getTemCode()">
                                    <ng-template pTemplate="selectedItem">
                                        <div class="country-item country-item-value" *ngIf="map_form.get('map_tipo_actor')">
                                            <div>
                                                {{ map_form.get("map_tipo_actor")?.value.name[lang.code] }}
                                            </div>
                                        </div>
                                    </ng-template>
                                    <ng-template let-country pTemplate="item">
                                        <div class="country-item">
                                            <div>{{ country.name[lang.code] }}</div>
                                        </div>
                                    </ng-template>
                                </p-dropdown>

                            </div>
                        </div>



                        <div class="col-lg-4 col-md-4 col-sm-4 col-xs-12">
                            <div class="field">
                                <label class="text-search">{{ "supplier_company" | translate }}
                </label>
                                <input id="map_search" formControlName="map_search" class="w-100" type="text" [placeholder]="'search' | translate" pInputText />
                            </div>
                        </div>
                        <div class="col-lg-4 col-md-4 col-sm-4 col-xs-12">
                            <div class="field">
                                <label class="text-search">{{
                  "year" | translate
                  }}</label>
                                <span class="p-input-icon-left w-100 w-search-list">
                  <i class="pi pi-calendar" style="color: var(--pf-blue)"></i>
                  <p-calendar appendTo="body" id="map_year" formControlName="map_year" view="year" dateFormat="yy" inputId="yearpicker"
                    [placeholder]="'year' | translate" [showClear]="true"></p-calendar>
                </span>
                            </div>

                        </div>
                        <div class="col-lg-4 col-md-4 col-sm-4 col-xs-12">
                            <div class="field">
                                <label class="text-search">{{
                  "period" | translate
                  }}</label>
                                <p-dropdown appendTo="body" id="map_listPeriod" [options]="listPeriod" optionLabel="name" [filter]="true" filterBy="name" [placeholder]="'period' | translate" [autoDisplayFirst]="false" formControlName="map_period" [showClear]="true">
                                    <ng-template pTemplate="selectedItem">
                                        <div class="country-item country-item-value" *ngIf="map_form.get('map_period')?.value['name']">
                                            <div>
                                                {{ map_form.get('map_period')?.value['name'] | translate }}
                                            </div>
                                        </div>
                                    </ng-template>
                                    <ng-template let-period pTemplate="item">
                                        <div class="country-item">
                                            <div>{{ period.name | translate }}</div>
                                        </div>
                                    </ng-template>
                                </p-dropdown>
                            </div>


                        </div>



                        <div class="col-lg-4 col-md-4 col-sm-4 col-xs-12">
                            <div class="field">
                                <label class="text-search">{{ "country" | translate }}
                </label>
                                <p-dropdown appendTo="body" *ngIf="listCountry" id="map_country" formControlName="map_country" [options]="listCountry" optionLabel="name" [filter]="true" filterBy="name" [showClear]="true" (onClear)="clearCountrySearchMap()" [placeholder]="'selected_country' | translate"
                                    [autoDisplayFirst]="false" (onChange)="getListRegions( (map_form.value?.map_country?map_form.value?.map_country.id:0) )">
                                    <ng-template pTemplate="selectedItem">
                                        <div class="country-item country-item-value" *ngIf="map_form.get('map_country')">
                                            <div>{{ map_form.get("map_country")?.value.name }}</div>
                                        </div>
                                    </ng-template>
                                    <ng-template let-country pTemplate="item">
                                        <div class="country-item">
                                            <div>{{ country.name }}</div>
                                        </div>
                                    </ng-template>
                                </p-dropdown>

                            </div>
                        </div>

                        <div class="col-lg-4 col-md-4 col-sm-4 col-xs-12">
                            <div class="field">
                                <label class="text-search">{{ "state" | translate }}
                </label>
                                <p-dropdown appendTo="body" id="state" formControlName="map_region" [options]="listRegions" optionLabel="name" [filter]="true" filterBy="name" [showClear]="true" (onClear)="clearRegionSearchMap()" [placeholder]="'selected_state' | translate" [autoDisplayFirst]="false"
                                    (onChange)="
        getListCities(
          (map_form.value?.map_country?map_form.value?.map_country.id:0),
          (map_form.value?.map_region?map_form.value.map_region.id:0)
        )
      ">
                                    <ng-template pTemplate="selectedItem">
                                        <div class="country-item country-item-value" *ngIf="map_form.get('map_region')">
                                            <div>{{ map_form.get("map_region")?.value.name }}</div>
                                        </div>
                                    </ng-template>
                                    <ng-template let-region pTemplate="item">
                                        <div class="country-item">
                                            <div>{{ region.name }}</div>
                                        </div>
                                    </ng-template>
                                </p-dropdown>

                            </div>
                        </div>

                        <div class="col-lg-4 col-md-4 col-sm-4 col-xs-12">
                            <div class="field">
                                <label class="text-search">{{ "municipality" | translate }}
                </label>
                                <p-dropdown appendTo="body" id="map_ciudad" formControlName="map_ciudad" [options]="listCities" optionLabel="name" [filter]="true" filterBy="name" [showClear]="true" (onClear)="clearCitySearchMap()" [placeholder]="'selected_municipality' | translate"
                                    [autoDisplayFirst]="false">
                                    <ng-template pTemplate="selectedItem">
                                        <div class="country-item country-item-value" *ngIf="map_form.get('map_ciudad')">
                                            <div>{{ map_form.get("map_ciudad")?.value.name }}</div>
                                        </div>
                                    </ng-template>
                                    <ng-template let-city pTemplate="item">
                                        <div class="country-item">
                                            <div>{{ city.name }}</div>
                                        </div>
                                    </ng-template>
                                </p-dropdown>

                            </div>
                        </div>


                        <div class="col-lg-6 col-md-6 col-sm-6 col-xs-12">
                            <button *ngIf="permissionView" (click)="resetAllSearcMap()" class="btn btn-pf-primary export-btn">
                {{ "search_all" | translate }}
              </button>
                        </div>

                    </div>
                </form>
            </div>
        </div>
    </div>
</p-dialog>